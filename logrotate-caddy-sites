# Caddy manages rotation of the active *.log files (see Caddyfile "log { roll_* }").
# This logrotate policy ONLY compresses and ages out Caddy's already-rotated files.
# Do NOT include /var/log/caddy/*.log here or you will fight Caddy's rotation.

# Compress and prune Caddy-rotated logs, regardless of suffix scheme.
# Caddy typically names rotated files with a timestamp, e.g. site-YYYYMMDD-HHMMSS.log
/var/log/caddy/*.log-* /var/log/caddy/*.log.* {
    missingok
    notifempty
    daily
    compress              # default gzip
    delaycompress         # compress on the next run to avoid racing any late writers
    maxage 90             # hard limit: delete anything older than 90 days
    su caddy caddy        # operate as the caddy user/group
    nocreate              # never create new files (Caddy creates the actives)
    sharedscripts
    # No postrotate needed; we aren't touching the active files.
}

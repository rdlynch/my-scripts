# Fail2Ban filter for Caddy web server
# Place in /etc/fail2ban/filter.d/caddy-auth.conf

[Definition]
# Match 401 Unauthorized and 403 Forbidden responses in Caddy JSON logs
failregex = ^.*\[ERROR\].*"remote_ip":"<HOST>".*"status":401.*$
            ^.*\[ERROR\].*"remote_ip":"<HOST>".*"status":403.*$
            ^.*\[ERROR\].*"remote_addr":"<HOST>".*"status":401.*$
            ^.*\[ERROR\].*"remote_addr":"<HOST>".*"status":403.*$

# Ignore legitimate requests (add patterns as needed)
ignoreregex = 

[Init]
# Maximum lines to buffer for multiline regex
maxlines = 1
